(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[385],{7468:function(e,t,r){Promise.resolve().then(r.bind(r,9276))},9276:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var s=r(7821),n=r(6179),l=r(8078),i=e=>{let{randomString:t}=e;return(0,s.jsxs)("div",{className:"relative z-10","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),(0,s.jsx)("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,s.jsx)("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-middle shadow-xl transition-all sm:my-8 p",children:(0,s.jsx)("div",{id:"item-size",className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-center sm:flex sm:items-center",children:[(0,s.jsx)("div",{className:"mx-auto flex h-12 w-16 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:(0,s.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),(0,s.jsx)("div",{className:"mx-auto text-center sm:ml-4 sm:mt-0 sm:text-center",children:(0,s.jsx)("h3",{className:"text-7xl font-bold leading-8 text-gray-900 uppercase tracking-widest",id:"modal-title",children:t})})]})})})})})]})},a=e=>{let{randomCode:t,serialReaction:r,setValid:n,addError:i,setFinished:a,isFinished:c}=e,[o,u]=(0,l.useState)(Date.now()),d=(0,l.useRef)(null),[f,m]=(0,l.useState)(!1),[x,p]=(0,l.useState)([,,,,].fill("")),h=(0,l.useCallback)((e,t)=>{p(()=>{let r=x.slice();return r[e]=t,r})},[x]),b=(0,l.useCallback)(e=>{let t=parseInt(e.currentTarget.dataset.index),r=d.current;if(isNaN(t)||null===r)return;let s=r.querySelector(".input-".concat(t-1)),n=r.querySelector(".input-".concat(t-1));switch(e.key){case"Backspace":x[t]||s&&s.select();break;case"ArrowRight":e.preventDefault(),n&&n.focus();break;case"ArrowLeft":e.preventDefault(),s&&s.focus()}},[x]);(0,l.useEffect)(()=>{let e=document.querySelector(".input-0");null==e||e.focus()},[]),(0,l.useLayoutEffect)(()=>{u(o)},[o]);let v=(0,l.useCallback)(e=>{let r=e.currentTarget.value,s=parseInt(e.currentTarget.dataset.index),n=d.current;if(isNaN(s)||null===n)return;let l=s+1,a=n.querySelector(".input-".concat(l)),c=x.slice();c[s]=r[0];let o=t.toLowerCase().startsWith(c.join("").toLowerCase());m(o),o?(h(s,r[0]||""),e.currentTarget.classList.remove("border-red-700"),e.currentTarget.classList.remove("ring-red-700"),1===r.length?null==a||a.focus():s<3&&r.slice(s+1,4).split("").forEach(e=>{h(l,e),null==a||a.focus(),l++,a=n.querySelector(".input-".concat(l))})):(i(),e.currentTarget.classList.add("border-red-500"),e.currentTarget.classList.add("ring-red-700"),e.currentTarget.focus())},[i,x,t,h]),g=e=>{e.currentTarget.select()};return(0,l.useEffect)(()=>{x.every(e=>""!=e)?(f?(r.spent_time=Date.now()-o,r.finished=!0,n(!0)):(r.spent_time=Date.now()-o,r.finished=!1,n(!1)),a(!0)):c&&(r.spent_time=Date.now()-o,r.finished=!1,n(!1),a(!1))},[x,r]),(0,s.jsx)("div",{className:"relative flex h-screen w-screen flex-col justify-center overflow-hidden bg-gray-50 py-12",children:(0,s.jsx)("div",{className:"relative bg-white px-6 pt-10 pb-9 shadow-xl mx-auto w-full max-w-lg rounded-2xl",children:(0,s.jsxs)("div",{className:"mx-auto flex w-full max-w-md flex-col space-y-16",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center text-center space-y-2",children:[(0,s.jsx)("div",{className:"font-semibold text-2xl text-blue-600",children:(0,s.jsx)("p",{children:"Escreva a sequ\xeancia correta das letras"})}),(0,s.jsx)("div",{className:"flex flex-row text-sm font-medium text-gray-400",children:(0,s.jsx)("p",{children:"Caso uma letra digitada for err\xf4nea ser\xe1 inv\xe1lidada a resposta"})})]}),(0,s.jsx)("div",{children:(0,s.jsx)("form",{ref:d,action:"",method:"post",children:(0,s.jsx)("div",{className:"flex flex-col space-y-16",children:(0,s.jsx)("div",{className:"flex flex-row items-center justify-between mx-auto w-full max-w-xs",children:x.map((e,t)=>(0,s.jsx)("div",{className:"w-16 h-16 ",children:(0,s.jsx)("input",{"data-index":t,onChange:e=>v(e),onKeyUp:b,onFocus:g,value:e,className:"input-".concat(t," w-full h-full flex flex-col items-center justify-center text-center px-5 outline-none rounded-xl border border-gray-200 text-lg text-black bg-white focus:bg-gray-50 focus:ring-1 ring-blue-700 uppercase"),type:"text",name:"",id:""})},t))})})})})]})})})},c=r(5249),o=(0,l.memo)(e=>{let{next:t,isFinished:r,updateBlock:n}=e,[o,u]=(0,l.useState)({err_numb:0,finished:!1}),[d,f]=(0,l.useState)(""),[m,x]=(0,l.useState)(!0),[p,h]=(0,l.useState)(!0),b=(0,l.useCallback)(()=>setTimeout(()=>{x(!1)},2e3),[]);return(0,l.useEffect)(()=>{!function(){let e=(0,c.Z)(),t=function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n="abcdefghijklmnopqrstuvwxyz",l=Math.floor(Math.random()*n.length);return r+=n[l],++s<t?e(t,r,s):r}(4);f(t),u(r=>({...r,id:e,serial_code:t}))}()},[]),(0,l.useEffect)(()=>{b()},[m,b]),(0,s.jsx)(s.Fragment,{children:m?(0,s.jsx)(i,{randomString:d}):(0,s.jsx)(a,{setFinished:e=>{console.log("setFinished"),n({...o,finished:p}),t(o,e)},isFinished:r,addError:()=>{o.err_numb+=1,u(e=>o),n(o)},serialReaction:o,setValid:h,randomCode:d})})});let u=(0,l.forwardRef)((e,t)=>{let{session:r,next:i}=e,[a,u]=(0,l.useState)(0),[d,f]=(0,l.useState)(!1),[m,x]=(0,l.useState)({}),[p,h]=(0,l.useState)(0),[b,v]=(0,l.useState)([]),[g,_]=(0,l.useState)([]);(0,l.useImperativeHandle)(t,()=>({isFinished:d}));let y=(0,n.useRouter)(),w=(0,l.useCallback)(e=>{if(r.blocks.length>0){let t=r.blocks.findIndex(t=>t.id===e.id);t<0?r.blocks.push(e):r.blocks[t]=e}else r.blocks.push(e)},[r.blocks]),j=(0,l.useCallback)(()=>{let e=(0,c.Z)();x(()=>({id:e}))},[]);(0,l.useEffect)(()=>{j()},[]),(0,l.useEffect)(()=>{let e=setInterval(()=>{let e=a+1e3;u(e),e>=r.max_time&&(console.log(r.max_time),f(!0))},1e3);return()=>clearInterval(e)},[r.max_time,a]);let k=(0,l.useCallback)(e=>{console.log("serial",e);let t=m.serial_reactions||[];if(console.log("block",m),t.length>0){let r=t.findIndex(t=>t.id===e.id);r<0?t.push(e):t[r]=e}else t.push(e);x({...m,serial_reactions:t})},[m]),N=(0,l.useCallback)(()=>{v(Array(r.number_serial_per_block).fill("").map((e,t)=>(0,s.jsx)(o,{isFinished:d,updateBlock:k,next:(e,t)=>{t&&h(p+1),_([...g,e])}},t)))},[p,d,g,r.number_serial_per_block,k]);(0,l.useEffect)(()=>{N()},[p,N,d,g,r.number_serial_per_block,k]);let S=(0,l.useCallback)(()=>{p===r.number_serial_per_block?(w({...m,completed:!0,number_serial_reactions_completed:p,serial_reactions:g,spent_time:g.reduce((e,t)=>e+t.spent_time,0)}),console.log(r),d?i():(j(),h(0),v([]),N(),_([]))):d&&(w({...m,completed:!1,number_serial_reactions_completed:p,serial_reactions:g,spent_time:g.reduce((e,t)=>e+t.spent_time,0)}),console.log(r),i())},[m,p,d,i,g,r,w]);return(0,l.useEffect)(()=>{S()},[p,d,y,g,r,S]),(0,s.jsx)("div",{children:b.map((e,t)=>{if(t===p)return e})})});u.displayName="Block";var d=r(7087),f=()=>{let e=(0,n.useSearchParams)(),t=(0,l.useRef)(null),[r,i]=(0,l.useState)({max_time:Number.MAX_VALUE}),{getUserSession:a}=(0,d.useAppContext)(),c=(0,n.useRouter)(),o=(0,l.useCallback)(()=>{t.current&&t.current.isFinished&&c.push("/session/new")},[c]);return(0,l.useEffect)(()=>{!function(){let t=a(e.get("session_id"));t&&i(t)}()},[a,e]),(0,s.jsx)("div",{className:"w-screen h-screen",children:(0,s.jsx)(u,{ref:t,next:o,session:r})})}},7087:function(e,t,r){"use strict";r.r(t),r.d(t,{AppProvider:function(){return i},useAppContext:function(){return a}});var s=r(7821),n=r(8078);let l=n.createContext({}),i=e=>{let{children:t}=e,[r,i]=(0,n.useState)([]),a=(0,n.useCallback)(e=>{i([...r,e])},[r]);return(0,s.jsx)(l.Provider,{value:{user_sessions:r||[],getUserSession:e=>r.find(t=>t.id===e),addUserSession:a,removeUserSession:e=>{i(r.filter(t=>t.id!==e.id))},wipeUsersSessions:()=>{i([])}},children:t})},a=()=>(0,n.useContext)(l)},8489:function(e,t,r){"use strict";var s=r(8078),n=Symbol.for("react.element"),l=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,r){var s,l={},o=null,u=null;for(s in void 0!==r&&(o=""+r),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,s)&&!c.hasOwnProperty(s)&&(l[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===l[s]&&(l[s]=t[s]);return{$$typeof:n,type:e,key:o,ref:u,props:l,_owner:a.current}}t.Fragment=l,t.jsx=o,t.jsxs=o},7821:function(e,t,r){"use strict";e.exports=r(8489)},6179:function(e,t,r){e.exports=r(319)},5249:function(e,t,r){"use strict";let s;r.d(t,{Z:function(){return a}});var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let l=new Uint8Array(16),i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));var a=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();let a=(e=e||{}).random||(e.rng||function(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(l)})();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]}(a)}}},function(e){e.O(0,[115,141,744],function(){return e(e.s=7468)}),_N_E=e.O()}]);